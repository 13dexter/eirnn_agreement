import torch
W_in = torch.tensor([[1.4876, 0.0000, 1.4247, 0.0000, 0.0672, 0.0000, 0.0778, 0.4056, 0.0000,
         0.0287, 0.3648, 0.0000, 0.0310, 0.0451, 0.0000, 1.1694, 0.0583, 1.9907,
         0.0000, 0.1528, 0.0000, 0.4076, 0.0000, 0.0000, 0.0000, 1.4021, 0.0000,
         0.0000, 0.0000, 0.1101, 0.8615, 1.5168, 0.0000, 0.9511, 0.0000, 0.0000,
         1.4538, 0.0000, 0.9955, 1.1527, 0.0000, 0.0000, 1.1901, 0.3555, 0.0000,
         0.0000, 2.3314, 1.0527, 0.7246, 0.5016],
        [0.0000, 0.0000, 1.5002, 0.8552, 0.2944, 0.2882, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.3790, 0.0000, 0.0000, 0.0000,
         0.3449, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5051,
         0.0000, 0.0000, 0.0000, 0.0000, 2.2826, 0.0000, 2.0883, 0.0000, 0.0000,
         0.0000, 0.1519, 0.0000, 0.0000, 0.0000, 0.0000, 0.9176, 0.0000, 1.7379,
         1.5866, 0.0000, 0.0000, 0.5105, 0.0000],
        [0.5420, 0.2991, 0.4131, 0.1091, 0.0000, 0.8368, 1.1786, 0.0889, 0.5748,
         0.6520, 0.6421, 0.1416, 0.0000, 0.0000, 1.0943, 2.2038, 0.0000, 0.0135,
         1.5278, 0.4000, 0.0000, 1.6057, 0.0000, 0.0000, 2.6309, 1.8548, 0.0000,
         1.3820, 0.8975, 0.0000, 0.4644, 0.0000, 0.0000, 0.0000, 1.1494, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.4181, 0.6465, 1.4606, 0.0296, 0.0000,
         0.0000, 1.1366, 0.0000, 0.0000, 0.0000],
        [0.9951, 1.6397, 1.3578, 0.4941, 0.0000, 0.0000, 0.0914, 0.8188, 0.0000,
         0.3644, 0.3357, 1.9079, 0.1675, 1.2114, 1.3267, 0.0000, 0.3759, 0.7311,
         0.0000, 0.0000, 0.0000, 0.4390, 0.0000, 0.9137, 0.2332, 1.3883, 0.0000,
         0.4039, 0.0000, 0.7663, 1.4120, 0.0337, 0.4103, 0.0000, 0.0000, 0.8746,
         0.0000, 0.0000, 0.0000, 2.2188, 0.0000, 0.1176, 0.7530, 0.0000, 0.8373,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7192, 0.2705, 0.0000, 0.1325,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.3254, 0.1687, 0.0000,
         1.1723, 0.0000, 0.4728, 1.2786, 0.5951, 0.7152, 0.0000, 0.0000, 0.3612,
         1.0127, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.4919, 0.0000, 0.2085,
         0.5046, 0.5586, 0.0000, 0.0000, 0.0000, 0.6860, 0.0263, 0.0000, 0.1296,
         2.2856, 1.9259, 0.7028, 0.3881, 0.0000],
        [0.0724, 0.0000, 0.3379, 0.0000, 0.0000, 0.0000, 0.0000, 0.1476, 0.0000,
         0.0000, 0.0000, 0.8751, 0.5029, 0.2971, 0.0000, 0.0000, 0.0000, 0.0000,
         0.6896, 0.0000, 0.2310, 0.4119, 0.0000, 0.7587, 0.2649, 1.0790, 0.0000,
         0.0000, 1.5512, 1.6920, 0.0000, 0.7305, 0.0000, 0.2288, 0.0000, 0.0000,
         0.3116, 0.0000, 0.0000, 0.0495, 0.1735, 0.0000, 0.0000, 0.4703, 0.0000,
         0.0000, 0.4743, 0.0000, 0.0000, 1.8792],
        [0.0000, 1.0644, 0.0189, 0.0000, 0.0000, 0.0000, 1.0740, 0.4694, 0.0000,
         0.0000, 0.0000, 0.0000, 0.7162, 1.4451, 1.3226, 0.5883, 0.0000, 0.0000,
         0.4559, 0.0000, 0.0000, 0.0000, 0.0000, 0.2832, 0.8933, 0.6597, 0.9022,
         0.5867, 0.0000, 0.0000, 0.3961, 0.5727, 1.3782, 1.0303, 0.0000, 0.7147,
         0.0000, 1.8293, 0.0000, 0.0000, 1.3301, 0.0000, 0.7481, 0.5894, 0.1252,
         0.0000, 0.0000, 0.5192, 0.7795, 0.6988],
        [0.0000, 0.0000, 0.0000, 0.5358, 0.6129, 0.0000, 0.0000, 1.5713, 0.7807,
         0.0000, 1.0314, 0.0000, 0.0000, 0.0000, 1.7521, 0.0000, 0.1171, 0.0000,
         0.0000, 0.0000, 0.5841, 0.4699, 0.0000, 0.0000, 0.1768, 0.0000, 0.0000,
         0.8072, 0.0000, 0.0000, 0.0640, 0.0000, 0.9411, 2.4100, 0.7093, 0.0000,
         0.0000, 1.2003, 0.1447, 1.2979, 0.0000, 0.0000, 0.0000, 0.0000, 0.4004,
         0.0000, 0.1406, 1.5343, 0.5485, 0.0000],
        [0.0000, 0.0322, 1.6778, 2.7887, 0.3032, 0.0000, 0.0000, 1.1577, 1.8138,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6167, 1.3692,
         0.9056, 0.3629, 0.0000, 0.0000, 0.1916, 0.8636, 0.5052, 1.4709, 0.4994,
         0.0000, 0.1115, 0.3312, 1.3786, 0.0588, 1.6170, 0.0013, 1.2364, 0.0000,
         1.3995, 0.0000, 0.0111, 0.5576, 0.0000, 0.3830, 0.0000, 0.0000, 0.6258,
         0.0000, 0.1532, 0.0000, 0.0000, 0.0000],
        [1.0530, 0.6146, 1.7917, 0.0000, 0.0000, 0.0000, 0.4535, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.5140, 0.7801, 0.5013, 0.0000, 0.0000, 0.0000,
         0.1162, 2.2418, 0.0000, 0.0000, 0.0000, 0.1013, 0.0386, 0.0000, 0.0000,
         0.0095, 0.0000, 0.0000, 0.3162, 0.7441, 0.0000, 0.0000, 0.0000, 0.4718,
         0.0000, 1.5236, 0.2903, 1.3536, 0.0000, 0.8430, 0.0000, 0.0000, 0.1345,
         0.4440, 0.7488, 0.0000, 1.9600, 0.5252],
        [1.3150, 1.8886, 0.0000, 0.0000, 0.0000, 0.0000, 0.5462, 0.0000, 0.0000,
         0.0000, 1.7090, 0.4391, 0.3527, 0.0000, 0.5482, 0.0000, 0.0000, 0.0000,
         0.0000, 0.3442, 0.0000, 0.0000, 1.8910, 0.0889, 1.9278, 0.0553, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0205, 0.2478, 0.0000, 0.0000, 0.5586, 0.0000,
         0.1168, 1.2815, 0.0000, 0.0000, 0.0000, 1.7599, 0.0000, 0.0000, 0.6921,
         0.0000, 0.0000, 0.0000, 0.0000, 1.1109],
        [1.0452, 0.0000, 1.4748, 0.0000, 2.0995, 0.0000, 1.4702, 0.0000, 0.0000,
         1.0294, 0.0000, 0.0000, 0.0000, 3.1066, 0.0000, 0.2632, 0.0000, 0.2789,
         0.5800, 0.0000, 0.0000, 0.0000, 1.5185, 1.9256, 0.0000, 0.1674, 1.0751,
         0.0000, 0.8645, 0.0000, 0.1285, 0.0000, 0.5573, 0.0000, 0.0000, 0.0000,
         0.0000, 0.7813, 0.0674, 0.2180, 0.0000, 0.9025, 1.6631, 0.1173, 0.6859,
         2.0976, 0.0000, 0.0294, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.4415, 0.0000, 0.5505, 1.7101, 0.8123, 0.0000, 0.0000,
         0.0000, 0.5933, 1.5741, 0.4498, 0.0000, 0.0000, 0.0000, 0.6848, 1.1434,
         1.1445, 1.3840, 0.2506, 0.0000, 0.0000, 0.1553, 0.4546, 0.9706, 1.0289,
         0.0000, 0.1133, 0.0000, 1.3758, 1.9958, 0.0000, 1.4753, 0.0000, 0.0000,
         2.0588, 0.0000, 0.0000, 0.0582, 0.0000, 0.0000, 0.0000, 0.0000, 0.5611,
         0.2843, 0.0000, 0.0000, 0.4392, 0.0000],
        [0.0000, 0.1256, 0.0000, 0.0000, 0.0000, 0.0000, 2.0633, 0.0000, 1.9314,
         0.4803, 0.0000, 0.0000, 1.6777, 0.0000, 0.0000, 0.0000, 0.0524, 1.4668,
         1.7580, 0.0000, 0.1080, 0.2014, 0.8150, 0.5797, 0.3711, 0.0000, 1.7286,
         1.1744, 0.5143, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0061,
         0.0000, 0.5332, 0.0000, 0.0000, 0.0000, 0.0000, 0.1053, 0.0000, 1.0964,
         1.6038, 2.7550, 0.3708, 0.0000, 0.0000],
        [0.0000, 0.7951, 0.1045, 1.3525, 0.0000, 0.0000, 0.0000, 0.2482, 0.5952,
         0.0000, 0.0000, 0.0000, 0.0000, 0.6258, 0.0000, 0.0546, 0.0000, 0.4991,
         1.6972, 0.2211, 0.0000, 0.8304, 1.8599, 0.0000, 0.5312, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.8364, 0.5404, 0.0000, 0.0000, 0.7172, 0.0000,
         0.0000, 0.0208, 1.7538, 0.9709, 0.0000, 0.5414, 0.0000, 0.2891, 0.0000,
         0.0000, 0.0000, 0.7359, 0.0000, 0.4533]])

W_rec = torch.tensor([[0.0000, 0.2243, 0.0000, 0.6741, 0.0000, 0.0000, 0.4230, 0.0000, 0.0000,
         0.8872, 0.0000, 1.7251, 0.0000, 0.5046, 0.0000],
        [0.0000, 0.0000, 0.3129, 1.0281, 0.0000, 0.0000, 0.0000, 0.0000, 0.1173,
         0.1432, 0.0000, 0.1010, 1.3662, 1.7497, 0.0000],
        [0.0000, 2.2574, 0.9470, 2.1603, 0.5168, 0.0000, 1.5112, 0.8464, 0.0000,
         1.6057, 0.4565, 0.6781, 0.1686, 0.4275, 0.0000],
        [0.8347, 0.0000, 0.0000, 0.0000, 0.0000, 0.1429, 0.9897, 1.0689, 0.3868,
         1.4063, 1.1495, 0.0000, 1.0085, 0.7009, 0.8520],
        [1.1977, 0.0599, 0.0000, 0.5659, 0.0000, 0.0000, 0.6217, 1.0016, 0.0471,
         0.0000, 0.0000, 0.2692, 1.4426, 0.0000, 0.0000],
        [0.0000, 1.9249, 1.1880, 0.2637, 0.0000, 0.0186, 0.0000, 0.0000, 0.0412,
         0.0000, 1.1401, 1.0657, 0.0000, 0.8949, 0.0000],
        [2.0697, 0.0000, 0.0000, 0.0000, 0.7573, 0.2887, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5221, 0.0000, 1.3481, 0.0000],
        [0.5186, 0.0000, 0.7828, 0.0000, 0.7593, 0.0000, 0.4386, 0.0000, 0.0000,
         0.7187, 0.0000, 0.0000, 0.0203, 0.0029, 1.2068],
        [0.0000, 0.0000, 0.0000, 0.6923, 1.3506, 0.0000, 0.5976, 0.0000, 0.0000,
         1.7076, 0.0000, 0.3267, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.8559, 0.0000, 0.0000, 0.0000, 0.0000, 1.0821,
         0.0000, 0.0000, 0.3431, 0.0000, 0.0000, 0.5894],
        [0.0907, 0.4248, 0.0000, 0.0000, 0.1328, 2.3718, 0.1275, 0.8161, 0.2324,
         0.4604, 0.0546, 0.0000, 0.0000, 0.0000, 0.0275],
        [1.0107, 1.9151, 1.0414, 0.1516, 0.0000, 0.0449, 0.0000, 0.4920, 1.0931,
         0.0000, 0.0000, 0.0000, 1.1191, 0.0000, 1.9656],
        [0.6655, 0.0000, 1.6355, 0.0000, 0.8676, 0.8980, 0.6034, 0.0000, 0.0000,
         0.0000, 0.4685, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 1.2253, 0.1016, 0.0000, 0.4989, 0.4903, 0.0000, 0.0001, 0.0000,
         0.0000, 0.0000, 1.7366, 0.0000, 0.6894, 0.3969],
        [0.0000, 1.1788, 0.0000, 0.0000, 0.7389, 0.0000, 1.1127, 0.9522, 0.3933,
         0.0000, 0.2818, 0.0000, 1.0622, 0.0000, 0.0000]])

W_out = torch.tensor([[0.7840, 0.2611, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 1.5812, 0.0000, 1.1092, 0.8236, 0.0000],
        [1.2468, 0.0000, 0.0000, 0.1668, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.4401, 0.0000, 0.0000, 0.2588, 0.0000, 0.0000, 1.0743, 0.9774,
         0.0000, 0.1825, 0.8086, 0.0484, 2.2715, 0.0000],
        [0.8097, 0.0000, 0.0000, 1.3388, 0.0000, 0.0000, 0.0000, 0.0000, 0.9142,
         0.0000, 2.1113, 0.0000, 0.0000, 0.2022, 0.5705],
        [0.5286, 0.0000, 0.0000, 0.5573, 0.0000, 0.9351, 2.6623, 0.6951, 0.1355,
         0.0000, 0.6314, 0.1413, 0.0000, 0.0000, 0.2293],
        [0.0007, 0.0000, 0.0000, 2.3740, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.4039, 0.0000, 0.0000, 0.1795, 0.7063],
        [0.2867, 0.0000, 0.7047, 0.0000, 0.0000, 0.2626, 1.1503, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.3158, 0.0000, 0.0000],
        [0.0000, 0.0682, 0.0000, 2.2666, 0.2917, 0.0000, 0.0000, 0.0000, 1.8278,
         1.4295, 0.0000, 0.8113, 0.4573, 2.2009, 0.7655],
        [0.6087, 1.2419, 1.0408, 0.8278, 1.0218, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.2704, 0.0000, 0.4414, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.3878, 1.1986, 0.7344, 0.0000, 0.0000,
         0.0000, 0.4898, 0.0000, 0.2997, 0.7967, 0.2339]])

print(W_in.size(), W_rec.size(), W_out.size())
print('--0.00--')
print (sum(sum(W_in == 0)))
print (sum(sum(W_rec == 0)))
print (sum(sum(W_out == 0)))
print (sum(W_rec == 0))
print (sum(W_rec.transpose(dim0=0, dim1=1) == 0))
print ('--0.05--')
print (sum(sum(W_in < 0.05)))
print (sum(sum(W_rec < 0.05)))
print (sum(sum(W_out < 0.05)))
print (sum(W_rec < 0.05))
print (sum(W_rec.transpose(dim0=0, dim1=1) < 0.05))